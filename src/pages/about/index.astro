---
import { getCollection } from 'astro:content';
import PageLayout from '@/layouts/CommonPage.astro';
import AuthorCard from '@/components/about/AuthorCard';
import PostCard from '@/components/about/PostCard';
import Single from '@/components/Single.astro';

// è·å–æœ€æ–°æ–‡ç« 
const allPosts = await getCollection('blog');
const latestPosts = allPosts
  .sort((a, b) => {
    const dateA = new Date(a.data.publishDate);
    const dateB = new Date(b.data.publishDate);
    return dateB.getTime() - dateA.getTime();
  })
  .slice(0, 3);

// å…³äºé¡µé¢æ•°æ®
const aboutData = [
  {
    single: [
      {
        tip: 'ä¸ªäººç®€ä»‹',
        title: 'å…³äºæˆ‘',
        content: 'ä¸€ä¸ªå¤§å­¦åœ¨è¯»ç‰›é©¬ï¼Œè‡ªåŠ¨åŒ–ä¸“ä¸šï¼Œåœ¨è¿™é‡Œè®°å½•ä¸€äº›æ–‡å­—ã€‚',
        lishi: 'æ¬¢è¿æ‚¨æ¥åˆ°æˆ‘çš„åšå®¢ğŸ“˜ï¼'
      }
    ]
  }
];
---

<PageLayout title='å…³äº' view>
  <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    {/* å…³äºæ ‡é¢˜ */}
    <div class="text-center mb-12">
      <h1 class="text-3xl sm:text-4xl font-bold text-slate-900 dark:text-white font-serif mb-4">å…³äº</h1>
    </div>
    
    {/* ä¸ªäººä¿¡æ¯å¡ç‰‡ */}
    <div class="mb-16 flex justify-center">
      <AuthorCard client:load className="max-w-4xl w-full" showLicense={false} />
    </div>

    {/* æœ€æ–°æ–‡ç«  */}
    <div class="max-w-4xl mx-auto mt-16">
      <div class="flex items-center gap-4 mb-8">
        <h2 class="text-2xl font-bold text-slate-900 dark:text-white font-serif">æœ€æ–°æ–‡ç« </h2>
        <div class="h-px flex-grow bg-slate-200 dark:bg-white/10"></div>
        <a href="/" class="text-sm font-medium text-blue-500 dark:text-blue-400 hover:underline">æŸ¥çœ‹å…¨éƒ¨</a>
      </div>
      <div class="flex flex-col gap-6">
        {latestPosts.map((post) => (
          <PostCard 
            client:load
            post={{
              id: post.id,
              title: post.data.title,
              summary: post.data.summary || '',
              date: new Date(post.data.publishDate).toLocaleDateString('zh-CN'),
              tags: post.data.tags || [],
              slug: post.id,
            }}
          />
        ))}
      </div>
    </div>

    {/* Singleç»„ä»¶ */}
    <div class="max-w-4xl mx-auto mt-16">
      <div class="flex items-center gap-4 mb-8">
        <h2 class="text-2xl font-bold text-slate-900 dark:text-white font-serif">æ›´å¤šä¿¡æ¯</h2>
        <div class="h-px flex-grow bg-slate-200 dark:bg-white/10"></div>
      </div>
      <Single about={aboutData} />
    </div>
  </div>
</PageLayout>
